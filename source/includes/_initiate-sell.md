# initiate-sell #

Create a SellCrypto transaction, and have the user start the checkout flow.

A SellCrypto transaction is initiated by the entity representing the end-user, such as a wallet app, an exchange, etc.

Each transaction has an identifier, which you use when referring to the transaction. This identifier is created by you, for your convenience, and passed to Simplex. It must be unique, so a good practice is to use a UUID4.

Other than `txn_id` and `ref_url` **all parameters are optional**.

When a parameter is required in order to complete the checkout flow, but is not supplied, Simplex will ask the end-user for it. For example: if `quote_id` is not supplied then Simplex will ask the end-user how much cryptocurrency they wish to sell, and will present an appropriate fiat quote.

Parameters in `account_details` are optional but allow Simplex's risk algorithms to approve a wider range of end-users. The more information you supply in `account_details` the more accurate Simplex's risk decisions will be, and as a result the happier your users become.

The response includes a transaction URL which you use to send your end-user to the checkout flow.

## Synopsis ##

API name: **`initiate-sell`**  
Direction: **You &rarr; Simplex**  
Transports: **REST, JWT**

## Parameters ##

> Example request

```json
{
  "txn_details": {
    "txn_id": "af492cb2-5b07-4318-8ece-be34f479e23b",
    "quote_id": "4c52ecda-e40e-4f94-89da-adc4e2e78b45",
    "src_crypto_addrs": [ "1EmXYy57z71H8J5jrxXsdjuJXZnPZgHnjh" ],
    "ref_url": "https://www.legit-site.com/pay-with-btc"
  },

  "account_details": {
    "account_id": "39cb996a-6cc8-43b9-ad37-1102a958ff38",

    "web_sessions": [{
      "ip": "74.115.209.58",
      "timestamp": 1529055882.223,
      "user_agent": "Mozilla/5.0 (Acme Laptop) AcmeWebKit/128 (KHTML, like Gecko) Chrome/65.0.1024.100",
      "uaid": "VHJhY2tpbmdDb29raWU",
      "http_accept_language": "en-US,en;q=0.9"
    }, {
      "ip": "74.115.209.61",
      "timestamp": 1536831495.900,
      "user_agent": "Mozilla/5.0 (Acme Laptop) AcmeWebKit/128 (KHTML, like Gecko) Chrome/65.0.1024.100",
      "uaid": "VHJhY2tpbmdDb29raWU",
      "http_accept_language": "en-US,en;q=0.9"
    }],

    "personal_details": {
      "first_name": "Wile",
      "last_name": "Coyote",
      "emails": [ "wile.e@rr.com" ],
      "phones": [ "+16085559103" ],
      "addrs": [{
        "line1": "42 Desert Road",
        "line2": "Apt. 314",
        "city": "San Diego",
        "zip": "22434",
        "country": "US",
        "state": "CA"
      }]
    }

  }
}
```

Name                      | Type                   |   |
------------------------- | ---------------------- | - |
                          |                        |
txn_details               |                        |
&emsp; txn_id             | Id                     | **required**
&emsp; ref_url            | String                 | **required**
&emsp; quote_id           | Id                     |
&emsp; src_crypto_addrs   | List\<CryptoAddr\>     |
&emsp; refund_crypto_addr | CryptoAddr             |
                          |                        |
account_details           |                        |
&emsp; account_id         | String                 |
&emsp; web_sessions       | List\<WebSessionInfo\> |
&emsp; personal_details   |                        |
&emsp; &emsp; first_name  | String                 |
&emsp; &emsp; last_name   | String                 |
&emsp; &emsp; emails      | List\<String\>         |
&emsp; &emsp; phones      | List\<String\>         |
&emsp; &emsp; addrs       | List\<Addr\>           |

Type `WebSessionInfo` :

Name                 | Type      |              | Description
-------------------- | --------- | ------------ | -----------
ip                   | String    | **required** | IPv4 of end-user's device
timestamp            | Timestamp | **required** | Timestamp of session start
user_agent           | String    |              | The `User-Agent` HTTP header from the end-user
uaid                 | String    |              | The value of a per-device tracking cookie that is managed by you; two equal `uaid`'s mean the same end-user device.
http_accept_language | String    |              | The `Accept-Language` HTTP header from the end-user

### txn_id ###
#### (Id, **required**)

A globally unique identifier for the transaction, generated by you.

This is a convenience feature: you may use the unique identifier you already have on your side for the transaction.

### ref_url ###
#### (String, **required**)

The value of the `Referer` HTTP header with which the user first landed on your site.

We're asking: where did the user arrive at your site from?

### quote_id ###
#### (Id, optional)

The `quote_id` returned by `get-quote`.

If this is missing then Simplex will provide the "Quote" user experience as the first stage in the checkout flow.

### src_crypto_addrs ###
#### (List\<CryptoAddr\>, optional)

The source crypto address(es) from which, when transaction is approved, the cryptocurrency will be sent on the blockchain.

Simplex uses these to run preliminary risk, policy and compliance checks.

### refund_crypto_addr ###
#### (CryptoAddr, optional)

The crypto address to which sent cryptocurrency will be returned in case of a refund.

If this is not provided, and only in case a refund is required, Simplex will invoke the `get-dst-crypto-addr` API with `"reason": "refund"`.

### account_id ###
#### (String, optional)

The identifier you use for the end-user's account.

<aside class="notice">
Make sure to pass this parameter; your users will thank you.
</aside>

Simplex uses `account_id` to identify returning users, and to afford them the smoothest possible experience. They won't need to fill-in nor verify their email or billing information, for example.

Instead of the actual account identifier you may send its hash, or anything else for which the following holds: _If I send the same `account_id` then it's the same account_.

### web_sessions ###
#### (List\<WebSessionInfo\>, optional)

A list of sessions/logins in the account, each with at least an IP and a timestamp.

If the account has more than 200 login events, include the first 100 and the last 100. In particular make sure to include the session in which the account was created.

Simplex uses these for policy and risk purposes, allowing your legitimate users to enjoy the credibility of their online identity.

### first_name ###
#### (String, optional)

The first name on the account.

### last_name ###
#### (String, optional)

The last name on the account.

### emails ###
#### (List\<String\>, optional)

A list of account email addresses, starting with the account's primary email address.

<aside class="notice">
Simplex will <strong>never</strong> send anything to any of these email addresses, and will never divulge them to a third party.
</aside>

Specify the primary email address first, followed by any other email addresses associated with the account, such as a secondary recovery email, past email addresses on the account, etc.

Simplex uses these for policy and risk purposes, allowing your legitimate users to enjoy the credibility of their online identity.

### phones ###
#### (List\<String\>, optional)

A list of account phone numbers, starting with the account's primary phone number.

<aside class="notice">
Simplex will <strong>never</strong> call any of these numbers, and will never divulge them to a third party.
</aside>

Specify the primary phone number first, followed by any other phone numbers associated with the account, such as a recovery phone number, past phone numbers on the account, etc.

Simplex uses these for policy and risk purposes, allowing your legitimate users to enjoy the credibility of their identity.

### addrs ###
#### (List\<Addr\>, optional)

A list of account mailing addresses, starting with the account's primary address.

<aside class="notice">
Simplex will <strong>never</strong> mail anything to any of these mailing addresses, and will never divulge them to a third party.
</aside>

Specify the primary mailing address first, followed by any other mailing addresses associated with the account.

Simplex uses these for policy and risk purposes, allowing your legitimate users to enjoy the credibility of their identity.

## Response ##

> Example response when a transaction is successfully created:

```json
{
  "txn_url": "https://checkout.simplexcc.com/sell?t=af492cb2-5b07-4318-8ece-be34f479e23b"
}
```

> Example error scenario:

```json
{
  "error": "duplicate txn_id"
}
```

Name    | Type
------- | ----
txn_url | String
error   | String

### txn_url ###
#### (String)

The URL where the checkout flow will take place. You should direct the end-user's browser there, either in a new tab, an iframe, or a webview in your app.

In case of an error `txn_url` will not be returned.

### error ###
#### (String)

In case of an error creating the transaction, `error` will be set to a short string describing the error, and `txn_url` will will not be returned. The error string is short and technical, and is not meant for end-users.

If the transaction was created successfully then `error` will not be returned.

## Transports ##

### REST ###

<span class="http-verb http-post">POST</span>`https://api.simplexcc.com/v1/rest/initiate-sell`

### JWT ###

<span class="http-verb http-get">GET</span>`https://api.simplexcc.com/v1/jwt`

[modeline]: # ( vim: set ts=2 sw=2 expandtab wrap linebreak: )
