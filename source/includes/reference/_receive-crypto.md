# receive-crypto #

A request from Simplex asking that you to watch your crypto destination address.

## Synopsis ##

API name: **`receive-crypto`**  
Direction: **Simplex &rarr; You**

## Parameters ##

> Example request:

```json
{
  "reason": "delivery",
  "txn_id": "af492cb2-5b07-4318-8ece-be34f479e23b",
  "crypto_currency": "BTC",
  "destination_crypto_address": "1EmXYy57z71H8J5jrxXsdjuJXZnPZgHnjh"
}
```

Name                       | Type           |   |
-------------------------- | -------------- | - |
reason                     | String         | **required**
txn_id                     | Id             | **required**
crypto_currency            | CryptoCurrency | **required**
destination_crypto_address | CryptoAddress  | **required**

### reason ###
#### (String, **required**)

The reason you are receiving cryptocurrency.

One of { `"delivery"`, `"refund"` }.

 * `"delivery"` : you are buying cryptocurrency: you are either the App (in a BuyCrypto transaction) or the Liquidity Receiver (in a SellCrypto transaction).

 * `"refund"` : the reverse of "delivery" -- we need to return to you, the original sender, cryptocurrency that you previously sent.

### txn_id ###
#### (Id, **required**)

The identifier of the Simplex transaction involved.

### crypto_currency ###
#### (CryptoCurrency, **required**)

The crypto currency (the currency, not the amount) to be received.

This will match the quote's `quote_currency`, and is supplied as a convenience.

### destination_crypto_address ###
#### (CryptoAddress, **required**)

The crypto address to which the cryptocurrency will be sent.

This is an address you previously supplied Simplex in response to a `get-destination-crypto-address` message.

## Type CryptoCheck ###

Name                   | Type           |   |
---------------------- | -------------- | - |
id                     | Id             | **required**
status                 | String         | **required**
result                 | String         | **required** if `status == "completed"`, missing otherwise
crypto_amount_received | MoneyAmount    | **required** if `result == "success"`, may be present even otherwise
blockchain_txn_hash    | Id             | **required** if `status == "confirming"` or `result == "success"`

### id ###
#### (Id, **required**)

An opaque string generated by you and stored by Simplex.

You may use this identifier to notify Simplex of the status of the crypto-check process once it changes, and Simplex may use it identifier to query you for the same.

### status ###
#### (String, **required**)

One of { `"pending"`, `"confirming"`, `"completed"` }.

### result ###
#### (String, **required** if `status == "completed"`, missing otherwise)

One of { `"success"`, `"timeout"` }.

### crypto_amount_received ###
#### (MoneyAmount, **required** if `result == "success"`, may be present even otherwise)

The actual amount received.


## Response ##

> Example response:

```json
{
  "crypto_check": {
    "id": "da8f72d2-d1c6-4468-89da-37f6d87f0cdf",
    "status": "completed",
    "crypto_amount_received": 500000,
    "result": "reject",
    "reasons": ["amount_mismatch"]
  }
}
```

Your response is a CryptoCheck object. If its status is `"pending"` you will need to later notify Simplex when the status changes to "completed". You do this using the `crypto-check-notify-status` message.

Alternatively, Simplex may poll you for the status, via either REST or MsgQueue, using `crypto-check-get-status`.

Name         | Type        |   |
------------ | ----------- | - |
crypto_check | CryptoCheck | **required**

## REST ##

If you supply a REST endpoint for this API, Simplex will use  
<span class="http-verb http-post">POST</span> `https://${YOUR_API_URL}/receive-crypto`

## MsgQueue ##

Alternatively, you may receive this request as a message of type `"receive-crypto"` in  
<span class="http-verb http-get">GET</span> `https://api.simplexcc.com/v3/msg`

You respond by  
<span class="http-verb http-post">POST</span> `https://api.simplexcc.com/v3/msg/:msg-id/response`

You will need to also acknowledge receipt of the message, by  
<span class="http-verb http-post">POST</span> `https://api.simplexcc.com/v3/msg/:msg-id/ack`

[modeline]: # ( vim: set ts=2 sw=2 expandtab wrap linebreak: )
